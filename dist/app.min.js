function WalletCtrl(a){var b=this;b.wallet={},b.balance=a.getBalance(),b.walletActions=a.actions,b.wallet.action=b.walletActions[0],b.submit=function(c){return c.amount<=0?void alert("Amount entered must be greater than 0 (zero)."):("add"===c.action.key?a.add(parseFloat(c.amount)):a.subtract(parseFloat(c.amount)),a.logTransaction(c.action,c.amount),b.balance=a.getBalance(),void(b.history=a.getHistory()))},b.reset=function(){localStorage.clear(),location.reload()}}function WalletHistory(a){return{restrict:"E",templateUrl:"partial/wallet-history.html",controllerAs:"whvm",controller:function(){this.history=a.getHistory()}}}function WalletService(){this.balance=null,this.history=null,this.actions=[{key:"add",label:"Deposit"},{key:"sub",label:"Withdraw"}],this.add=function(a){this.balance+=a,this.persist()},this.subtract=function(a){this.balance-a<0?this.balance=0:this.balance-=a,this.persist()},this.persist=function(){if("undefined"==typeof localStorage)alert("Your browser does not support HTML5 localStorage. Try upgrading.");else try{localStorage.setItem("history",JSON.stringify(this.history)),localStorage.setItem("balance",this.balance)}catch(a){a==QUOTA_EXCEEDED_ERR&&alert("Quota exceeded!")}},this.getBalance=function(){return null===this.balance&&(this.balance=this.getBalanceFromStorage()),this.balance},this.logTransaction=function(a,b){var c={date:new Date,amount:b,deposit:!1,withdrawal:!1};"add"===a.key?c.deposit=!0:c.withdrawal=!0,this.history.push(c),this.persist()},this.getHistory=function(){return null===this.history&&(this.history=this.getHistoryFromStorage()),this.history},this.getBalanceFromStorage=function(){if("undefined"!=typeof localStorage){var a=localStorage.getItem("balance");return null===a?0:parseFloat(a)}return alert("Your browser does not support HTML5 localStorage. Try upgrading."),0},this.getHistoryFromStorage=function(){if("undefined"!=typeof localStorage){var a=localStorage.getItem("history");return null===a?[]:JSON.parse(a)}return alert("Your browser does not support HTML5 localStorage. Try upgrading."),[]}}WalletCtrl.$inject=["WalletService"],WalletHistory.$inject=["WalletService"],function(){angular.module("wallet",[]).service("WalletService",WalletService).controller("WalletCtrl",WalletCtrl).directive("walletHistory",WalletHistory),angular.module("app",["wallet"])}();